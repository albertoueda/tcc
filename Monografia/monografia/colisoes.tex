Uma das características das plataformas que suportam simulações físicas como Chipmunk é a capacidade de detectar colisões entre os objetos. 
Para detectar colisões de forma eficiente as plataformas utilizam um processo com duas fases: broad phase e a narrow phase. 

A finalidade da broad phase é evitar a realização de cálculos caros para corpos distantes umas das outras. O Chipmunk suporta as seguintes estruturas de dados para
gerar os pares de objetos que devem passar pelo algoritmo de detecção de colisão:
árvores AABB, 1D Sort and Sweep e o Spatial Hashing. Na versão 5 do Chipmunk a estrutuda de dados utilizado é o Spatial Hashing enquanto na versão 6
é o algoritmo árvores AABB. 

Narrow phase é a fase onde pares de objetos são verificados cuidadosamente por colisão. O Chipmunk suporta somente polígonos convexos nesta fase e devido a 
esse motivo, não é possível criar objetos côncavos.

Nas próximas seções serão explicadas resumidamente os algoritmos de cada fase.

\subsection{Broad Phase - Árvore AABB}

Para enteder a árvore AABB, é preciso primeiro entender o que é AABB. AABB é um acrônimo para Axis Aligned Bounding Box que são caixas delimitadoras de objetos 
em formas de retângulo e alinhado com os eixos x e y como mostra a figura 3:

\begin{figure}[!htbp]
  \centering
  \includegraphics[scale=0.3]{mario_bb.png}
  \caption{O retângulo azul representa uma caixa delimitadora do objeto}
\end{figure}

\ \\
A árvore AABB é uma árvore binária que faz proveito da AABB para armazenar e consultar objetos no espaço 2D. O nó da árvore pode guardar o próprio objeto 
ou possuir dois nós filhos. Quando um nó guarda um objeto, a caixa delimitadora deste nó deve conter a caixa delimitadora do objeto. Se o nó possui nós filhos, 
sua caixa delimitadora deve conter as caixas delimitadoras dos nós filhos. 
Um ponto importante é que esta estrutura precisa de uma heurística para inserir os nós na árvore. No caso do Chipmunk existe uma heurística baseada na caixa 
delimitadora do objeto e também em relação ao velocidade dela. Na figura 4 mostramos um exemplo de uma árvore AABB de três objetos A, B e C: 

\begin{figure}[!htbp]
  \includegraphics[scale=0.4]{AABBTree.png}
  \caption{Exemplo de uma árvore AABB}
\end{figure}

\ \\
A caixa delimitadora da raiz é o retângulo preto contendo os objetos A, B e C.
As duas novas caixas delimitadoras criadas pela linha indicado pelo número 1 são agora filhas da raiz. 
E finalmente a linha indicado pelo número 2 criam mais duas caixas delimitadoras separando os objetos A e B.

A figura 5 mostra como são definidos os pares de objetos que passarão pela narrow phase. Começando pela raíz, a caixa delimitadora do objeto D intersecta somente 
com a caixa delimitadora do nó esquerdo. Em seguida a caixa delimitadora do objeto D intersecta somente com a caixa delimitadora da folha contendo o objeto A.
Então o par criado nessa busca é o par \{A, D\}.

\begin{figure}[!htbp]
  \includegraphics[scale=0.4]{AABBTree1.png}
  \caption{Exemplo de detecção de colisão. O objeto D é comparado somente com a folha contendo o objeto A.}
\end{figure}

\subsection{Broad Phase - 1D Sweep and Prune}

A idéia do algoritmo é varrer as caixas delimitadoras dos objetos criando assim os pares de objetos que deverão ser passados para a fase seguinte. 

Seguindo o exemplo da figura 7, o algoritmo mantêm uma lista de objetos que estão sendo varridos. Quando a varredura encontra o início do objeto, ela o inclui na lista. 
Quando a varredura encontra o final do objeto, ela o exclui da lista. No exemplo observamos que a lista [A, B, C] criam os pares \{A, B\}, \{A, C\} e \{B, C\} 
enquanto a lista [B, D] cria o par \{B, D\}. 

\begin{figure}[!htbp]
  \includegraphics[scale=0.7]{sp.png}
  \caption{Exemplo de um algoritmo Sweep and Prune}
\end{figure}

Esse algoritmo, de acordo com a documentação do Chipmunk 6, Ele pode ser muito eficiente em jogos móveis se o seu mundo é muito comprido e plano 
como um jogo de corrida

\subsection{Broad Phase - Spatial Hashing}

Spatial Hashing é um processo onde o espaço de duas ou três dimensões é projetado em uma tabela hash de uma dimensão. 
